<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>CAT</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: linear-gradient(#fdf6e3, #f5efe6);
      font-family: system-ui, -apple-system, "Noto Sans TC", sans-serif;
    }

    #hint {
      position: fixed;
      top: 16px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 15px;
      color: #666;
      pointer-events: none;
    }

    canvas {
      display: block;
    }
  </style>
</head>
<body>

<canvas id="game"></canvas>
<div id="hint">é»æ“Šç•«é¢ï¼Œè£½é€ å…‰é»ï¼Œé»‘è²“æœƒæ…¢æ…¢è¿½éå»</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

let time = 0;
let idleTime = 0;

const light = {
  x: 0,
  y: 0,
  active: false
};

const cat = {
  x: canvas.width / 2,
  y: canvas.height / 2,
  angle: 0,
  speed: 0.05,
  boost: 1,
  sleeping: false
};

// äº’å‹•
canvas.addEventListener("click", e => {
  light.x = e.clientX;
  light.y = e.clientY;
  light.active = true;
  idleTime = 0;
  cat.sleeping = false;
});

canvas.addEventListener("mousedown", () => cat.boost = 2.5);
canvas.addEventListener("mouseup", () => cat.boost = 1);

function update() {
  if (!light.active) return;

  const dx = light.x - cat.x;
  const dy = light.y - cat.y;
  const dist = Math.hypot(dx, dy);

  // æ•´éš»è²“è½‰å‘å…‰é»
  cat.angle = Math.atan2(dy, dx);

  // é è¿‘å…‰é» â†’ é–‹å§‹ idle
  if (dist < 25) {
    idleTime++;
    if (idleTime > 180) {
      cat.sleeping = true;
    }
    return;
  }

  // ç§»å‹•ä¸­
  idleTime = 0;
  cat.sleeping = false;

  cat.x += dx * cat.speed * cat.boost;
  cat.y += dy * cat.speed * cat.boost;
}

function drawLight() {
  if (!light.active) return;
  const pulse = Math.sin(time * 2) * 2;
  ctx.beginPath();
  ctx.arc(light.x, light.y, 8 + pulse, 0, Math.PI * 2);
  ctx.fillStyle = "rgba(255,170,120,0.9)";
  ctx.fill();
}

function drawCat() {
  ctx.save();
  ctx.translate(cat.x, cat.y);
  ctx.rotate(cat.angle);

  const bodyColor = "#222";
  const eyeColor = "#ffd966";

  // ğŸˆ èº«é«”ï¼ˆç¡è¦ºæœƒè¶´æ‰ï¼‰
  ctx.fillStyle = bodyColor;
  ctx.save();
  ctx.translate(0, 14);
  ctx.scale(3.2, cat.sleeping ? 0.7 : 1.2);
  ctx.beginPath();
  ctx.arc(0, 0, 22, 0, Math.PI * 2);
  ctx.fill();
  ctx.restore();

  // é ­
  ctx.beginPath();
  ctx.arc(50, 2, 24, 0, Math.PI * 2);
  ctx.fill();

  // è€³æœµ
  ctx.beginPath();
  ctx.moveTo(56, -20);
  ctx.lineTo(66, -38);
  ctx.lineTo(44, -24);
  ctx.closePath();
  ctx.fill();

  // ğŸ‘€ çœ¼ç›
  ctx.strokeStyle = eyeColor;
  ctx.lineWidth = 2;
  if (cat.sleeping) {
    // é–‰çœ¼
    ctx.beginPath();
    ctx.moveTo(48, 2);
    ctx.lineTo(60, 2);
    ctx.stroke();
  } else {
    ctx.fillStyle = eyeColor;
    ctx.beginPath();
    ctx.arc(56, 2, 4, 0, Math.PI * 2);
    ctx.fill();
  }

  // ğŸ¾ è…³ï¼ˆé†’è‘—æ‰å‹•ï¼‰
  if (!cat.sleeping) {
    const sway = Math.sin(time * 0.6) * 6;
    ctx.strokeStyle = bodyColor;
    ctx.lineWidth = 9;
    ctx.lineCap = "round";

    // å‰è…³
    ctx.beginPath();
    ctx.moveTo(22 + sway, 30);
    ctx.lineTo(22 - sway, 52);
    ctx.stroke();

    // å¾Œè…³
    ctx.beginPath();
    ctx.moveTo(-6 - sway, 30);
    ctx.lineTo(-6 + sway, 52);
    ctx.stroke();
  }

  // ğŸ–¤ å°¾å·´ï¼ˆç¡è¦ºæ™‚ä¹Ÿä¿æŒé»‘è‰²ï¼‰
  ctx.strokeStyle = "#222";
  ctx.lineWidth = 9;
  ctx.lineCap = "round";

  const wag = Math.sin(time * (cat.sleeping ? 0.3 : 0.8)) * 14;
  ctx.beginPath();
  ctx.moveTo(-70, 14);
  ctx.quadraticCurveTo(-100, wag, -80, -22 + wag);
  ctx.stroke();

  // ğŸ˜´ Zzz
  if (cat.sleeping) {
    ctx.fillStyle = "#888";
    ctx.font = "16px sans-serif";
    ctx.fillText(
      "Zzz",
      30,
      -40 - Math.sin(time * 0.5) * 6
    );
  }

  ctx.restore();
}

function loop() {
  time += 0.05;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  update();
  drawLight();
  drawCat();
  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
